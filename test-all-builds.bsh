#!/bin/bash

for i in `find . ! -iname ".gradle" ! -iname ".git" -type d -depth 1`; do
    pushd $i
    
    if test "$1" == clean
    then
        gradle clean
    else
        run-example.bsh
    
        # Test for failure
        BUILD_RESULT="$?"
        echo ""
        echo "  +++++++++++++++++++++++++++++++++++++"
        echo "  SCRIPTED BUILD RESULT: $BUILD_RESULT"
        echo "  +++++++++++++++++++++++++++++++++++++"
        echo ""
        
        if test "$BUILD_RESULT" != "0"
        then
            echo **********************************************************************
            echo ************* A sub-build has failed. Build is halting. **************
            exit 1
        fi
    fi
    
    popd
done
