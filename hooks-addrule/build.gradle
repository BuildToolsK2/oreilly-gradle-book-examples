ext {
  pingTimeout = 5000
  pingLogDir = "${buildDir}/reachable"
}

tasks.addRule('Rule Usage: ping<Hostname>') { String taskName ->
  if(taskName.startsWith('ping')) {
    task(taskName) {
      ext.hostname = taskName - 'ping'
      def logDir
      doLast {
        def host = InetAddress.getByName(ext.hostname)
        def reachable = host.isReachable(project.ext.pingTimeout)
        ext.reachable = reachable
        def log = "${new Date()}\t${ext.reachable}\n"
        file(pingLogDir).mkdirs()
        file("${pingLogDir}/${ext.hostname}") << log
      }
    }
  }
}
